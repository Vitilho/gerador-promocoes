<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Postagens - Central do Vitilho</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; padding: 20px; display: flex; gap: 20px; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 450px; }
        .preview-container { flex-grow: 1; background: #eef2f7; padding: 20px; border-radius: 8px; position: sticky; top: 20px; height: fit-content; }
        h2 { font-size: 1.2rem; margin-top: 0; color: #333; }
        label { display: block; margin-top: 10px; font-weight: bold; font-size: 0.85rem; }
        input { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .output { background: white; padding: 15px; border: 1px solid #ddd; border-radius: 4px; white-space: pre-wrap; margin-bottom: 15px; font-family: 'Segoe UI Emoji', sans-serif; min-height: 200px; }
        button { width: 100%; padding: 10px; margin-top: 10px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        .btn-copy { background-color: #28a745; color: white; }
        .btn-clear { background-color: #dc3545; color: white; }
    </style>
</head>
<body>

<div class="container">
    <h2>üõ† Dados da Promo√ß√£o</h2>
    
    <label>Produto</label>
    <input type="text" id="produto" placeholder="Ex: RTX 5060" oninput="update()" autofocus>
    
    <label>Coment√°rio Produto</label>
    <input type="text" id="comentarioProd" oninput="update()">
    
    <label>Cupom</label>
    <input type="text" id="cupom" oninput="update()">
    
    <label>Pre√ßo De (R$)</label>
    <input type="text" id="precoDe" placeholder="3.999,00" oninput="update()">
    
    <label>Pre√ßo Por (R$)</label>
    <input type="text" id="precoPor" placeholder="2.269,55" oninput="update()">
    
    <label>Desconto (%)</label>
    <input type="text" id="desconto" placeholder="Ex: -43" oninput="update()">
    
    <label>Parcelamento</label>
    <input type="text" id="parcelas" placeholder="10x de R$ 226,95" oninput="update()">

    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-top: 15px;">
        <input type="checkbox" id="freteGratis" onchange="update()" checked style="width: auto;"> Possui Frete Gr√°tis?
    </label>
    
    <label>Link</label>
    <input type="text" id="link" oninput="update()">
    
    <label>Loja/Vendedor</label>
    <input type="text" id="loja" oninput="update()">

    <button class="btn-clear" onclick="clearFields()">Limpar Tudo</button>
</div>

<div class="preview-container">
    <h2>üì± Preview (Pronto para Copiar)</h2>
    <div id="result" class="output"></div>
    <button class="btn-copy" onclick="copyToClipboard()">Copiar Postagem</button>
</div>

<script>
    function formatarMoeda(valor) {
        if (!valor || isNaN(valor)) return "";
        return valor.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function update() {
        const getValRaw = (id) => {
            let val = document.getElementById(id).value;
            if (!val) return 0;
            let cleanVal = val.replace(/\./g, '').replace(',', '.');
            return parseFloat(cleanVal) || 0;
        };
        
        const p = (id) => document.getElementById(id).value;
        const temFrete = document.getElementById('freteGratis').checked;
        
        let numDe = getValRaw('precoDe');
        let numPor = getValRaw('precoPor');
        let descManual = p('desconto');
        let descCalculado = "";

        if (numDe > 0 && numPor > 0) {
            if (descManual) {
                descCalculado = descManual.includes('%') ? descManual : `-${descManual.replace('-', '')}%`;
            } else {
                let calculo = Math.round(((numDe - numPor) / numDe) * 100);
                descCalculado = (calculo > 0) ? `-${calculo}%` : `0%`;
            }
        } else if (descManual) {
            descCalculado = descManual.includes('%') ? descManual : `-${descManual.replace('-', '')}%`;
        }

        const precoDeFormatado = formatarMoeda(numDe);
        const precoPorFormatado = formatarMoeda(numPor);

        let postagem = `‚úÖ ${p('produto')}\n`;
        if(p('comentarioProd')) postagem += `> ${p('comentarioProd')}\n\n`;
        else postagem += `\n`;

        if(p('cupom')) postagem += `üè∑Ô∏è Cupom: *${p('cupom').toUpperCase()}*\n`;
        if(precoDeFormatado) postagem += `üí∞ De: R$ ${precoDeFormatado}\n`;
        if(precoPorFormatado) postagem += `üî• Por: R$ ${precoPorFormatado} \`${descCalculado}\`\n`;
        if(p('parcelas')) postagem += `üí≥ Parcelamento: ${p('parcelas')}\n`;
        if(temFrete) postagem += `üöö Frete Gr√°tis\n`;
        if(p('link')) postagem += `\nüîó ${p('link')}\n`;
        if(p('loja')) postagem += `> ${p('loja')}`;

        document.getElementById('result').innerText = postagem;
    }

    function copyToClipboard() {
        const text = document.getElementById('result').innerText;
        navigator.clipboard.writeText(text).then(() => {
            const btn = document.querySelector('.btn-copy');
            btn.innerText = "‚úÖ Copiado!";
            setTimeout(() => { btn.innerText = "Copiar Postagem"; }, 2000);
        });
    }

    function clearFields() {
        document.querySelectorAll('input').forEach(i => i.value = '');
        document.getElementById('freteGratis').checked = true;
        update();
        document.getElementById('produto').focus();
    }

    // Inicializa√ß√£o
    window.onload = () => {
        update();
        document.getElementById('produto').focus();
    };
</script>

</body>
</html>
